<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="pwn,">










<meta name="description" content="Pwnç³»åˆ—ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²å‰è¨€åœ¨ä¸Šå‘¨æ—¥çš„å—äº¬ç†å·¥çº¿ä¸‹æ–°ç”Ÿèµ›ï¼ˆç°åœºï¼‰ä¸­é‡åˆ°äº†è¿™é“é¢˜ï¼Œå½“æ—¶å±…ç„¶æ²¡åšå‡ºæ¥ï¼Œè¿™å°±å¼€å§‹è¡¥è¯¾ã€‚">
<meta name="keywords" content="pwn">
<meta property="og:type" content="article">
<meta property="og:title" content="Pwn-series-Format-String">
<meta property="og:url" content="http://blog.fxti.xyz/2019/04/23/Pwn-series-Format-String/index.html">
<meta property="og:site_name" content="FXTi&#39;s blog">
<meta property="og:description" content="Pwnç³»åˆ—ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²å‰è¨€åœ¨ä¸Šå‘¨æ—¥çš„å—äº¬ç†å·¥çº¿ä¸‹æ–°ç”Ÿèµ›ï¼ˆç°åœºï¼‰ä¸­é‡åˆ°äº†è¿™é“é¢˜ï¼Œå½“æ—¶å±…ç„¶æ²¡åšå‡ºæ¥ï¼Œè¿™å°±å¼€å§‹è¡¥è¯¾ã€‚">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-04-23T15:29:25.850Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pwn-series-Format-String">
<meta name="twitter:description" content="Pwnç³»åˆ—ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²å‰è¨€åœ¨ä¸Šå‘¨æ—¥çš„å—äº¬ç†å·¥çº¿ä¸‹æ–°ç”Ÿèµ›ï¼ˆç°åœºï¼‰ä¸­é‡åˆ°äº†è¿™é“é¢˜ï¼Œå½“æ—¶å±…ç„¶æ²¡åšå‡ºæ¥ï¼Œè¿™å°±å¼€å§‹è¡¥è¯¾ã€‚">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.fxti.xyz/2019/04/23/Pwn-series-Format-String/">





  <title>radare2-reverse-self-modified-binary | FXTi's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">FXTi's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.fxti.xyz/2019/02/12/radare2-reverse-self-modified-binary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FX-Ti">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FXTi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">radare2-reverse-self-modified-binary</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-12T13:30:58+08:00">2019-02-12</time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶"></a>ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶</h1><p>è¯‘è‡ªï¼š</p>
<blockquote>
<p><a href="https://www.megabeets.net/reversing-a-self-modifying-binary-with-radare2/" target="_blank" rel="noopener">https://www.megabeets.net/reversing-a-self-modifying-binary-with-radare2/</a></p>
</blockquote>
<h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>å†™è¿™ç¯‡æ–‡ç« èŠ±äº†æˆ‘ä¸‰ä¸ªæœˆï¼Œæˆ‘çš„TODOåˆ—è¡¨ä¸Šæœ‰å¤ªå¤šçš„ä»»åŠ¡ä»¥è‡´äºè¿™ç¯‡æ–‡ç« è¢«æ”¾åˆ°äº†æœ€åæ‰å¼€å§‹å†™ã€‚ä¸Šå‘¨æˆ‘ä¸‹å®šå†³å¿ƒï¼Œåˆ°å‘¨æ—¥æˆ‘å°±å†™å®Œè¿™ç¯‡æ–‡ç« ã€‚ç„¶åæˆ‘åšåˆ°äº†ï¼Œç»™ä½ ä»¬å¸¦æ¥äº†åˆä¸€ç¯‡Radare2çš„æŒ‡å—ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬è¦å®Œæˆä¸€ä¸ªæœ‰è¶£çš„æŒ‘æˆ˜ï¼Œåå«â€packedupâ€ï¼Œæ˜¯ad3lä¸ºr2con2017æ¯”èµ›å†™çš„ã€‚è¿™ä¸æ˜¯æˆ‘ä¸ºr2conæ¯”èµ›å†™çš„ç¬¬ä¸€ç¯‡writeupï¼Œä½ ä¹Ÿå¯ä»¥çœ‹çœ‹<a href="https://www.megabeets.net/reverse-engineering-a-gameboy-rom-with-radare2/" target="_blank" rel="noopener">ç”¨Radare2é€†å‘ä¸€ä¸ªGameboyROM</a>ï¼Œç¡®ä¿ä½ ä¸ä¼šé”™è¿‡æˆ‘èµ¢å¾—é‚£æ¬¡æ¯”èµ›çš„è¿‡ç¨‹ä¸­çš„æ”¶è·ä¸ä½“ä¼šã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ˜¯ä¸ºå·²ç»ç†Ÿæ‚‰Radare2çš„äººæ‰€å†™çš„ã€‚å¦‚æœä½ ä¸æ˜¯ï¼Œæˆ‘å»ºè®®ä½ ä»ç³»åˆ—â€œRadare2ä¹‹æ—…â€çš„<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a>(<a href="https://www.anquanke.com/post/id/86850" target="_blank" rel="noopener">å®‰å…¨å®¢</a>)å¼€å§‹ã€‚</p>
<p>é—²è¯å°‘å™ï¼Œè®©æˆ‘ä»¬å¼€å§‹åˆ†æè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<a id="more"></a> 
<img src="/2019/02/12/radare2-reverse-self-modified-binary/r2.png">
<h2 id="è·å–Radare2"><a href="#è·å–Radare2" class="headerlink" title="è·å–Radare2"></a>è·å–Radare2</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>Radare2çš„å¼€å‘éå¸¸è¿…é€Ÿï¼Œè¿™ä¸ªé¡¹ç›®æ¯å¤©éƒ½åœ¨æ›´æ–°æ‰€ä»¥å»ºè®®ä½ ä½¿ç”¨æœ€æ–°çš„githubç‰ˆæœ¬ï¼Œä¸è¦ä½¿ç”¨stableç‰ˆï¼Œå› ä¸ºæœ‰æ—¶å€™stableç‰ˆå¯èƒ½è¿˜æ²¡æœ‰æœ€æ–°çš„github ç‰ˆç¨³å®šã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/radare/radare2.git</span><br><span class="line">$ <span class="built_in">cd</span> radare2</span><br><span class="line">$ ./sys/install.sh</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨githubç‰ˆï¼Œæˆ–è€…æƒ³è¦æ¯ä¸ªå¹³å°(Windows,OS X,iOS,ç­‰ç­‰)ç›¸å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé‚£å°±ç‚¹å‡»<a href="http://radare.org/r/down.html" target="_blank" rel="noopener">Radare2ä¸‹è½½é¡µé¢</a>å»ä¸‹è½½ã€‚</p>
<h3 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h3><p>æ­£å¦‚å‰é¢æ‰€è¯´çš„ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ä»gitä»“åº“è·å–çš„æœ€æ–°ç‰ˆçš„r2ã€‚è¿™æ ·ä½ åªéœ€è¦ç”¨gitæ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤å°±è¡Œäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./sys/install.sh</span><br></pre></td></tr></table></figure>
<p>æˆ‘ç»å¸¸é€šè¿‡å®šæ—¶ä»»åŠ¡åœ¨æ—©ä¸Šè‡ªåŠ¨æ›´æ–°Radare2ï¼Œè¿™æ ·æ¯å¤©ç”¨çš„éƒ½æ˜¯æœ€æ–°ç‰ˆã€‚å¦‚æœä½ ç»å¸¸ç”¨Radare2ï¼Œæˆ‘å»ºè®®ä½ ä¹Ÿè¿™ä¹ˆåšã€‚</p>
<h3 id="packedup"><a href="#packedup" class="headerlink" title="packedup"></a>packedup</h3><p>ä½ å¯ä»¥ä»<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Generic/packedup%20-%20Self-modifying%20binary/packedup" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½packedupã€‚æˆ‘å»ºè®®ä½ ç»™è¿™ä¸ªä»“åº“ä¸€ä¸ªæ˜Ÿæ˜Ÿ(â˜…)æ¥è·å¾—è¿™ä¸ªç³»åˆ—çš„æ›´å¤šæ›´æ–°ã€‚</p>
<p>é¦–å…ˆè¿è¡Œä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çœ‹çœ‹æƒ…å†µã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ./packedup </span><br><span class="line">Welcome to packedup <span class="keyword">for</span> r2crackmes :)</span><br><span class="line">Flag &lt;&lt; MEGABEETS     </span><br><span class="line">Try again!</span><br></pre></td></tr></table></figure>
<p>packedupæ‰§è¡Œåè¦æ±‚æˆ‘ä»¬è¾“å…¥flagã€‚å®ƒå¾ˆå¯èƒ½ä¹‹åè¿›è¡Œä¸€äº›è®¡ç®—æ¥ç¡®å®šæˆ‘ä»¬æ˜¯å¦è¾“å…¥äº†æ­£ç¡®çš„flagã€‚æˆ‘è¾“å…¥â€MEGABEETSâ€ç„¶åè¾“å‡ºäº†é”™è¯¯ä¿¡æ¯â€Try again!â€</p>
<h2 id="å¼€å§‹é€†å‘ï¼"><a href="#å¼€å§‹é€†å‘ï¼" class="headerlink" title="å¼€å§‹é€†å‘ï¼"></a>å¼€å§‹é€†å‘ï¼</h2><p>å¼€å§‹æˆ‘ä»¬æœ€å–œæ¬¢çš„éƒ¨åˆ†ï¼Œç”¨Radare2æ‰“å¼€æ–‡ä»¶ç„¶åå¼„æ¸…æ¥šå®ƒæ€ä¹ˆæ£€æŸ¥æäº¤çš„flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ r2 ./packedup</span><br><span class="line">â€” Here be dragons.</span><br><span class="line">[0x004004d0]&gt; aaa</span><br><span class="line">[x] Analyze all flags starting with sym. and entry0 (aa)</span><br><span class="line">[x] Analyze len bytes of instructions <span class="keyword">for</span> references (aar)</span><br><span class="line">[x] Analyze <span class="keyword">function</span> calls (aac)</span><br><span class="line">[*] Use -AA or aaaa to perform additional experimental analysis.</span><br><span class="line">[x] Constructing a <span class="keyword">function</span> name <span class="keyword">for</span> fcn.* and sym.func.* <span class="built_in">functions</span> (aan)</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æˆ‘ç»å¸¸èµ·æ‰‹æ‰§è¡Œ<code>aa</code>(åˆ†æå…¨éƒ¨)æˆ–è€…<code>aas</code>(åˆ†æå‡½æ•°ã€ç¬¦å·ç­‰)ã€‚è¿™ç¼©å†™æœ‰äº›è¯¯å¯¼å› ä¸ºå®é™…ä¸Šåˆ†æä»»åŠ¡å¾ˆç¹æ‚(å…·ä½“å¯ä»¥æŸ¥çœ‹<code>aa?</code>)ï¼Œä½†è¿™å¯¹äºæˆ‘æµ‹è¯•è¿‡çš„äºŒè¿›åˆ¶æ–‡ä»¶è¿™å·²ç»å¤Ÿäº†ã€‚å› ä¸ºè¿™æ¬¡æ–‡ä»¶å°ï¼Œæˆ‘ç›´æ¥é€šè¿‡<code>aaa</code>ä¸€æ¬¡æå®šã€‚ä½ ä¹Ÿèƒ½é€šè¿‡<code>-A</code>å‚æ•°æ¥è¿è¡Œradare2æ¥å¯åŠ¨æ‰§è¡Œ<code>aaa</code>(ä¾‹å¦‚<code>r2 -A ./packedup</code>)ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šæ­£å¦‚æˆ‘åœ¨å‰ä¸€ç¯‡åšæ–‡ä¸­æåˆ°è¿‡çš„ï¼Œå› ä¸ºåˆ†æè¿‡ç¨‹éå¸¸å¤æ‚ï¼Œæ‰€ä»¥å¯åŠ¨æ‰§è¡Œ<code>aaa</code>å¹¶éæ¨èå®è·µã€‚å…·ä½“å¯ä»¥çœ‹çœ‹æˆ‘åœ¨è¿™ä¸ª<a href="https://reverseengineering.stackexchange.com/a/16115/18698" target="_blank" rel="noopener">å›ç­”</a>ä¸­çš„è¯¦ç»†è§£é‡Šã€‚</p>
</blockquote>
<h3 id="è·å–ä¿¡æ¯"><a href="#è·å–ä¿¡æ¯" class="headerlink" title="è·å–ä¿¡æ¯"></a>è·å–ä¿¡æ¯</h3><p>ç”¨Radare2æ‰“å¼€æ–‡ä»¶åï¼Œè‡ªåŠ¨å®šä½åˆ°ç¨‹åºå…¥å£ç‚¹ã€‚ä½†åœ¨å¼€å§‹åˆ†æä»£ç ä¹‹å‰æœ€å¥½å…ˆçœ‹çœ‹æ–‡ä»¶ä¿¡æ¯ã€‚Radare2å¯ä»¥ç”¨<code>i</code>æŒ‡ä»¤æ˜¾ç¤ºä¿¡æ¯(ä¸ºäº†å¯è¯»è¡Œç®€åŒ–è¿‡äº†)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[0x004004d0]&gt; i</span><br><span class="line">...</span><br><span class="line">file ./packedup</span><br><span class="line">format elf64</span><br><span class="line">iorw <span class="literal">false</span></span><br><span class="line">mode -r-x</span><br><span class="line">size 0x1878</span><br><span class="line">humansz 6.1K</span><br><span class="line"><span class="built_in">type</span> EXEC (Executable file)</span><br><span class="line">arch x86</span><br><span class="line">...</span><br><span class="line">bintype elf</span><br><span class="line">bits 64</span><br><span class="line">...</span><br><span class="line">endian little</span><br><span class="line">...</span><br><span class="line">intrp /lib64/ld-linux-x86-64.so.2</span><br><span class="line">lang c</span><br><span class="line">...</span><br><span class="line">machine AMD x86-64 architecture</span><br><span class="line">stripped <span class="literal">true</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>i</code>æŒ‡ä»¤ç”¨æ¥æ˜¾ç¤ºå·²æ‰“å¼€æ–‡ä»¶çš„ä¿¡æ¯ã€‚è¯¥æŒ‡ä»¤ä½¿ç”¨<code>rabin2</code>è¿™ä¸ªradare2æ¡†æ¶ä¸­çš„ä¿¡æ¯æå–å·¥å…·ã€‚Radare2æä¾›äº†è¯¥æ–‡ä»¶çš„å¤§é‡ä¿¡æ¯ã€‚ç”¨<code>i?</code>æŒ‡ä»¤æŸ¥çœ‹æ›´å¤šå­å‘½ä»¤ã€‚</p>
</blockquote>
<p>packedupæ˜¯ä¸ª64ä½å»ç¬¦å·è¡¨ELFæ–‡ä»¶ã€‚æœ‰æ„æ€ï¼Œç»§ç»­åˆ†æã€‚</p>
<h3 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><p>æˆ‘æœ€å–œæ¬¢å¼€å§‹åˆ†æçš„æ–¹å¼ä¹‹ä¸€ä¾¿æ˜¯æŸ¥æ‰¾å¯ç–‘çš„å­—ç¬¦ä¸²ï¼Œå°¤å…¶æ˜¯å¼•ç”¨è¿™äº›å­—ç¬¦ä¸²çš„ä½ç½®ã€‚ç”¨<code>iz</code>åˆ—å‡ºdataåŒºæ®µçš„å…¨éƒ¨å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[0x004004d0]&gt; iz</span><br><span class="line">001 0x000007d0 0x004007d0 46 47 (.rodata) ascii Welcome to packedup <span class="keyword">for</span> r2crackmes :)\nFlag &lt;&lt;</span><br><span class="line">002 0x00000800 0x00400800 11 12 (.rodata) ascii Try again!\n</span><br><span class="line">003 0x0000080d 0x0040080d 26 27 (.rodata) ascii Yep! you got the flag  \n</span><br></pre></td></tr></table></figure>
<p>ä¸é”™ï¼Œå¯ä»¥çœ‹åˆ°bannerå­—ç¬¦ä¸²ä»¥åŠæˆåŠŸå’Œå¤±è´¥ä¿¡æ¯ã€‚å†çœ‹çœ‹æ˜¯å“ªé‡Œçš„ä»£ç å¼•ç”¨äº†å®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Radare2å†…ç½®çš„å¾ªç¯æœºåˆ¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[0x004004d0]&gt; axt @@ str.*</span><br><span class="line">main 0x400619 [data] mov esi, str.Welcome_to_packedup_for_r2crackmes_:___Flag</span><br><span class="line">main 0x4006b8 [data] mov esi, str.Try_again</span><br><span class="line">main 0x4006de [data] mov esi, str.Yep__you_got_the_flag_:</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ¡æŒ‡ä»¤å±•ç°äº†Radare2æ›´å¤šçš„ç‰¹æ€§ã€‚<code>axt</code>æŒ‡ä»¤ç”¨æ¥æŸ¥æ‰¾å¼•ç”¨è¿™ä¸ªåœ°å€æœ‰å…³çš„ä»£ç æˆ–æ•°æ®å¼•ç”¨(å¯æŸ¥çœ‹<code>ax?</code>)ã€‚<br><code>@@</code>ç±»ä¼¼äºè¿­ä»£å™¨ç¬¦å·ï¼Œç”¨æ¥å¯¹äºä¸€ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªåç§»åœ°å€é‡å¤æ‰§è¡ŒæŒ‡ä»¤(å¯æŸ¥çœ‹<code>@@?</code>)ã€‚ç„¶å<code>str.*</code>æ˜¯å¯¹äºæ‰€æœ‰<code>str.</code>å¼€å§‹çš„æ ‡è®°çš„é€šé…ç¬¦ã€‚<br>æ‰€ä»¥è¿™ä¸€æ•´æ¡æŒ‡ä»¤ä¸ä»…åˆ—å‡ºäº†å­—ç¬¦ä¸²æœ¬èº«è¿˜åŒ…æ‹¬å¼•ç”¨å®ƒä»¬çš„å‡½æ•°åå’Œç›¸å…³çš„ä»£ç ä½ç½®ã€‚</p>
</blockquote>
<h3 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h3><p>ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ½æ˜¯ç”±mainå‡½æ•°æ‰€å¼•ç”¨çš„ï¼Œä¸ºäº†å¯¼èˆªåˆ°å¯¹åº”ä½ç½®è¦ä½¿ç”¨seekæŒ‡ä»¤<code>s</code>ã€‚é€šè¿‡åœ¨å‡ ä¹æ‰€æœ‰æŒ‡ä»¤ååŠ <code>?</code>å°±èƒ½çœ‹åˆ°è¯¦ç»†çš„å¸®åŠ©ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[0x08048370]&gt; s?</span><br><span class="line">|Usage: s  <span class="comment"># Seek commands</span></span><br><span class="line">| s                 Print current address</span><br><span class="line">| s addr            Seek to address</span><br><span class="line">| s-                Undo seek</span><br><span class="line">| s- n              Seek n bytes backward</span><br><span class="line">| sâ€“                Seek blocksize bytes backward</span><br><span class="line">| s+                Redo seek</span><br><span class="line">| s+ n              Seek n bytes forward</span><br><span class="line">| s++               Seek blocksize bytes forward</span><br><span class="line">| s[j*=]            List undo seek <span class="built_in">history</span> (JSON, =list, *r2)</span><br><span class="line">| s/ DATA           Search <span class="keyword">for</span> next occurrence of â€˜DATAâ€™</span><br><span class="line">| s/x 9091          Search <span class="keyword">for</span> next occurrence of \x90\x91</span><br><span class="line">| s.hexoff          Seek honoring a base from core-&gt;offset</span><br><span class="line">| sa [[+-]a] [asz]  Seek asz (or bsize) aligned to addr</span><br><span class="line">| sb                Seek aligned to bb start</span><br><span class="line">| sC[?] string      Seek to comment matching given string</span><br><span class="line">| sf                Seek to next <span class="keyword">function</span> (f-&gt;addr+f-&gt;size)</span><br><span class="line">| sf <span class="keyword">function</span>       Seek to address of specified <span class="keyword">function</span></span><br><span class="line">| sg/sG             Seek begin (sg) or end (sG) of section or file</span><br><span class="line">| sl[?] [+-]line    Seek to line</span><br><span class="line">| sn/sp             Seek next/prev scr.nkey</span><br><span class="line">| so [N]            Seek to N next opcode(s)</span><br><span class="line">| sr pc             Seek to register</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥åŸºæœ¬ä¸Šï¼ŒseekæŒ‡ä»¤æ¥å—åœ°å€æˆ–è€…æ•°å­¦è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚å®šä½åˆ°mainå‡½æ•°å¾ˆç®€å•ï¼Œç›´æ¥æ‰§è¡Œ<code>s main</code>å³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[0x004004d0]&gt; s main</span><br><span class="line">[0x0040060c]&gt;</span><br></pre></td></tr></table></figure>
<h3 id="åæ±‡ç¼–"><a href="#åæ±‡ç¼–" class="headerlink" title="åæ±‡ç¼–"></a>åæ±‡ç¼–</h3><p>ç°åœ¨ä½äºmainå‡½æ•°éœ€è¦æ‰“å°æ±‡ç¼–ä»£ç çœ‹çœ‹ã€‚Radare2æä¾›äº†å¤šç§æ–¹å¼åæ±‡ç¼–ä¸€ä¸ªå‡½æ•°ã€‚å¯ä»¥ç”¨<code>pdf</code>(æ˜¾ç¤ºå‡½æ•°åæ±‡ç¼–)æˆ–è€…äº¤äº’æ€§æ›´å¼ºçš„å¯è§†åŒ–æ¨¡å¼(<code>v</code>)å’Œå›¾å½¢æ¨¡å¼(<code>VV</code>)ï¼Œé€‰å“ªä¸ªä½ å–œæ¬¢å°±å¥½ã€‚æˆ‘æƒ¯ç”¨å¯è§†åŒ–æ¨¡å¼å› ä¸ºä¿¡æ¯æ›´åŠ ä¸°å¯Œï¼Œäº¤äº’æ€§ä¹Ÿå¥½ã€‚æˆ‘åœ¨<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">ä¸Šä¸€ç¯‡</a>è¯¦ç»†è®²è§£è¿‡ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¯ä½¿ç”¨ã€‚</p>
<img src="/2019/02/12/radare2-reverse-self-modified-binary/visual.png">
<p>è®©æˆ‘ä»¬çœ‹çœ‹mainå‡½æ•°çš„å¼€å§‹éƒ¨åˆ†ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt; pdf</span><br><span class="line">â•­ (fcn) main 244</span><br><span class="line">â”‚   main ();</span><br><span class="line">â”‚           ; var int local_10h @ rbp-0x10</span><br><span class="line">â”‚           ; var int local_ch @ rbp-0xc</span><br><span class="line">â”‚           ; var int local_8h @ rbp-0x8</span><br><span class="line">â”‚              ; JMP XREF from 0x00400605 (entry2.init)</span><br><span class="line">â”‚              ; DATA XREF from 0x004004ed (entry0)</span><br><span class="line">â”‚           0x0040060c      55             push rbp</span><br><span class="line">â”‚           0x0040060d      4889e5         mov rbp, rsp</span><br><span class="line">â”‚           0x00400610      4883ec10       sub rsp, 0x10</span><br><span class="line">â”‚              ; DATA XREF from 0x00400653 (main)</span><br><span class="line">â”‚              ; DATA XREF from 0x004005e7 (entry2.init)</span><br><span class="line">â”‚           0x00400614      ba30000000     mov edx, 0x30</span><br><span class="line">â”‚           0x00400619      bed0074000     mov esi, str.Welcome_to_packedup_for_r2crackmes_:___Flag ; 0x4007d0 ; â€œWelcome to packedup <span class="keyword">for</span> r2crackmes :)\nFlag &lt;&lt; â€œ</span><br><span class="line">â”‚           0x0040061e      bf01000000     mov edi, 1</span><br><span class="line">â”‚           0x00400623      b800000000     mov eax, 0</span><br><span class="line">â”‚           0x00400628      e853feffff     call sym.imp.write      ; ssize_t write(int fd, void *ptr, size_t nbytes)</span><br><span class="line">â”‚           0x0040062d      ba2c000000     mov edx, 0x2c           ; â€˜,â€™ ; 44</span><br><span class="line">â”‚           0x00400632      be80106000     mov esi, 0x601080</span><br><span class="line">â”‚           0x00400637      bf00000000     mov edi, 0</span><br><span class="line">â”‚           0x0040063c      b800000000     mov eax, 0</span><br><span class="line">â”‚           0x00400641      e84afeffff     call sym.imp.read       ; ssize_t <span class="built_in">read</span>(int fildes, void *buf, size_t nbyte)</span><br><span class="line">â”‚           0x00400646      4898           cdqe</span><br><span class="line">â”‚           0x00400648      488945f8       mov qword [local_8h], rax</span><br><span class="line">â”‚           0x0040064c      c745f0000000.  mov dword [local_10h], 0</span><br><span class="line">â”‚           0x00400653      b814064000     mov eax, 0x400614</span><br><span class="line">â”‚           0x00400658      bbf6064000     mov ebx, 0x4006f6</span><br><span class="line">â”‚           0x0040065d      29c3           sub ebx, eax</span><br><span class="line">â”‚           0x0040065f      31c9           xor ecx, ecx</span><br></pre></td></tr></table></figure>
<p>åœ¨å‡½æ•°åˆå§‹åŒ–ä¹‹åï¼Œèƒ½çœ‹åˆ°å‚æ•°ä¼ é€’åˆ°<code>write()</code>æ‰“å°å‡ºbannerä¿¡æ¯ç„¶åå¦ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>read()</code>ä»stdinè¯»å–è¾“å…¥ã€‚<code>read()</code>ä»stdinè¯»å–0x2c(åè¿›åˆ¶:44)å­—èŠ‚å­˜å‚¨åˆ°ä½äº0x601080çš„ç¼“å†²åŒºã€‚å‡è®¾flagå¾ˆå¯èƒ½é•¿ä¸º44ä¸ªå­—ç¬¦ï¼Œé‡å‘½åä¿å­˜è¾“å…¥çš„åœ°å€æ¥æ–¹ä¾¿è‡ªå·±è¯†åˆ«ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt; f loc.our_input = 0x601080</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>f</code>ç”¨æ¥ä¸ºä¸€ä¸ªç‰¹å®šåœ°å€åˆ›å»ºflag(æ ‡è®°)ã€‚æ›´å¤šä¿¡æ¯å¯æŸ¥çœ‹<code>f?</code>å¹¶é˜…è¯»<a href="https://radare.gitbooks.io/radare2book/content/basic_commands/flags.html" target="_blank" rel="noopener">è¿™ä¸€ç« </a>ã€‚</p>
</blockquote>
<p>ç„¶åç¨‹åºä¿å­˜è¯»å…¥å­—èŠ‚æ•°åˆ°ä¸€ä¸ªæœ¬åœ°å˜é‡ã€‚åœ¨<em>0x400653</em>åœ°å€<em>0x400614</em>å­˜å…¥<code>eax</code>ï¼Œåœ°å€<em>0x4006f6</em>å­˜å…¥<code>ebx</code>ã€‚ç¬¬ä¸€ä¸ªåœ°å€æ˜¯mainå‡½æ•°åˆå§‹åŒ–éƒ¨åˆ†ä¹‹åçš„åœ°å€ï¼Œç¬¬äºŒä¸ªæ˜¯mainå‡½æ•°è¿”å›ä¹‹å‰çš„åœ°å€ã€‚ä¹‹å<code>ebx</code>å‡å»<code>eax</code>æ‰€ä»¥<code>ebx</code>ä¸­å­˜å‚¨ç€ä¸¤ä¸ªåœ°å€çš„å·®å€¼ã€‚</p>
<p>ä¸‹ä¸€éƒ¨åˆ†ï¼Œç¨‹åºä½¿ç”¨åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ä½¿ç”¨è‡ªèº«çš„ä»£ç è®¡ç®—å‡ºäº†ä¸€ä¸ªåˆå§‹å€¼ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â€¦</span><br><span class="line"></span><br><span class="line">â”‚           0x00400653      b814064000     mov eax, 0x400614</span><br><span class="line">â”‚           0x00400658      bbf6064000     mov ebx, 0x4006f6</span><br><span class="line">â”‚           0x0040065d      29c3           sub ebx, eax</span><br><span class="line">â”‚           0x0040065f      31c9           xor ecx, ecx</span><br><span class="line">â”‚              ; JMP XREF from 0x0040066b (main)</span><br><span class="line">â”‚       â•­â”€&gt; 0x00400661      670208         add cl, byte [eax]</span><br><span class="line">â”‚       â   0x00400664      c1c904         ror ecx, 4</span><br><span class="line">â”‚       â   0x00400667      ffc0           inc eax</span><br><span class="line">â”‚       â   0x00400669      ffcb           dec ebx</span><br><span class="line">â”‚       â•°â”€&lt; 0x0040066b      75f4           jne 0x400661</span><br><span class="line">â”‚           0x0040066d      89ca           mov edx, ecx</span><br><span class="line"></span><br><span class="line">â€¦</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸‹ä¸ªå¾ªç¯ä¸­èƒ½çœ‹åˆ°ç¨‹åºåœ¨éªŒè¯è¾“å…¥ã€‚é¦–å…ˆçœ‹çœ‹æœ€ç›¸å…³çš„éƒ¨åˆ†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â”‚           0x0040066d      89ca           mov edx, ecx</span><br><span class="line">â”‚           0x0040066f      89d0           mov eax, edx</span><br><span class="line">â”‚           0x00400671      8945f0         mov dword [local_10h], eax</span><br><span class="line">â”‚           0x00400674      c745f42c0000.  mov dword [local_ch], 0x2c  ; â€˜,â€™ ; 44</span><br><span class="line">â”‚              ; JMP XREF from 0x004006f4 (main)</span><br><span class="line">â”‚           0x0040067b      8b45f0         mov eax, dword [local_10h]</span><br><span class="line">â”‚           0x0040067e      89c0           mov eax, eax</span><br><span class="line">â”‚           0x00400680      d1c0           rol eax, 1</span><br><span class="line">â”‚           0x00400682      8945f0         mov dword [local_10h], eax</span><br><span class="line">â”‚           0x00400685      8b45f0         mov eax, dword [local_10h]</span><br><span class="line">â”‚           0x00400688      0fb6d0         movzx edx, al</span><br><span class="line">â”‚           0x0040068b      8b45f4         mov eax, dword [local_ch]</span><br><span class="line">â”‚           0x0040068e      83e801         sub eax, 1</span><br><span class="line">â”‚           0x00400691      4898           cdqe</span><br><span class="line">â”‚           0x00400693      0fb688801060.  movzx ecx, byte [rax + 0x601080] ; [0x601080:1]=0</span><br><span class="line">â”‚           0x0040069a      8b45f4         mov eax, dword [local_ch]</span><br><span class="line">â”‚           0x0040069d      83e801         sub eax, 1</span><br><span class="line">â”‚           0x004006a0      4898           cdqe</span><br><span class="line">â”‚           0x004006a2      0fb680a00740.  movzx eax, byte [rax + 0x4007a0] ; [0x4007a0:1]=15</span><br><span class="line">â”‚           0x004006a9      31c8           xor eax, ecx</span><br><span class="line">â”‚           0x004006ab      0fb6c0         movzx eax, al</span><br><span class="line">â”‚           0x004006ae      39c2           cmp edx, eax</span><br><span class="line">â”‚       â•­â”€&lt; 0x004006b0      741c           je 0x4006ce</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¹‹å‰å¾ªç¯ä¸­è®¡ç®—çš„åˆå§‹å€¼è¢«ç§»å…¥<code>edx</code>(<em>0x40066d</em>)ï¼Œä¹‹ååˆå…ˆè¿›å…¥<code>eax</code>å†è¿›å…¥<code>[local_10h]</code>ã€‚å†è¿›å…¥éªŒè¯å¾ªç¯ï¼Œåˆå§‹å€¼ä»<code>[local_10h]</code>åˆ°<code>eax</code>ï¼Œç„¶å<code>eax</code>è¢«å·¦ç§»1å­—èŠ‚(<em>0x400680</em>)ç„¶åå†æ¬¡è¢«ç§»åˆ°<code>[local_10h]</code>ã€‚åœ¨<em>0x400688</em>ä½å­—èŠ‚<code>al</code>ä¸­çš„å€¼è¢«ç§»åˆ°<code>edx</code>ã€‚åœ¨<em>0x400693</em>ç¨‹åºä»è¾“å…¥å–1å­—èŠ‚åˆ°<code>ecx</code>ã€‚åœ¨<em>0x4006a2</em>ï¼Œç¨‹åºä»<code>[rax + 0x4007a0]</code>å–1å­—èŠ‚åˆ°<code>eax</code>ã€‚çœ‹çœ‹<code>0x4007a0</code>æœ‰ä»€ä¹ˆï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt; px 44 @ 0x4007a0</span><br><span class="line">â€“ offset â€“   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF</span><br><span class="line">0x004007a0  0fc9 a886 ace0 1893 8aaf 91a2 e464 7a5a  .............dzZ</span><br><span class="line">0x004007b0  088b a89a b4d1 1f84 b4d1 7152 1c8a 80d2  ..........qR....</span><br><span class="line">0x004007c0  1495 8297 80d2 1f90 8f91 93a6            ............</span><br></pre></td></tr></table></figure>
<p>ä¸é”™ï¼Œè¿™æ˜¯é¢„å®šä¹‰çš„44å­—èŠ‚æ•°ç»„ï¼Œå®šç„¶ç”¨åœ¨äº†æ¯”è¾ƒè¿‡ç¨‹ä¸­ã€‚ç»™å®ƒå–ä¸ªåå­—å«<code>loc.predefined_array</code>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt; f loc.predefined_array = 0x4007a0</span><br></pre></td></tr></table></figure>
<p>å†ç»§ç»­ä¹‹å‰æé†’ä¸€ä¸‹ï¼Œ<code>edx</code>ä¿å­˜ç€ç§»ä½è¿‡çš„åˆå§‹å€¼ï¼Œ<code>eax</code>ä¿å­˜ç€<code>loc.predefined_array[0x2c-1]</code>çš„1å­—èŠ‚å†…å®¹,<code>ecx</code>ä¿å­˜ç€è¾“å…¥å­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</p>
<p>åœ¨<em>0x4006a9</em>ï¼Œ<code>ecx</code>å’Œ<code>eax</code>ä½å¼‚æˆ–ç»“æœå­˜å‚¨åœ¨<code>eax</code>ã€‚ç„¶å<code>al</code>æ‹“å±•åˆ°<code>eax</code>å¹¶ä¸”å’Œ<code>edx</code>æ¯”è¾ƒ(ç§»ä½è¿‡çš„åˆå§‹å€¼)ã€‚å¯ä»¥å†™å‡ºå¦‚ä¸‹Pythonä¼ªä»£ç ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">key = 0x???????? <span class="comment"># Our initial_value</span></span><br><span class="line">our_input = <span class="string">"A"</span> * 44</span><br><span class="line">predefined_array = [0x0fc9, ... ,0x93a6]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> ( ord(our_input[-1]) ^ predefined_array[-1] ) == ( key &amp; 0xff ):</span><br><span class="line">    <span class="built_in">return</span> True</span><br></pre></td></tr></table></figure>
<p>å¦‚æœç»“æœç›¸ç­‰ï¼Œæ¯”å¦‚<code>ecx ^ eax == edx</code>ï¼Œå¾ªç¯ä»¥è¾“å…¥çš„å€’æ•°ç¬¬äºŒä¸ªå­—æ¯å’Œ<code>loc.predefined_array[0x2c-2]</code>å¼€å§‹å¹¶ä¸”å’Œ<code>rol(key)</code>æ¯”è¾ƒã€‚<code>key</code>å®é™…ä¸Šæ˜¯å·¦ç§»çš„<code>initial_value</code>ï¼Œæ­£å› ä¸ºè¿™ä¸ªå€¼æ¯æ¬¡å·¦ç§»éƒ½ä¼šæ”¹å˜æ‰€ä»¥è¢«ç§°ä¸º<code>key</code>ã€‚</p>
<h3 id="ç¬¬ä¸€æ¬¡æ±‚è§£"><a href="#ç¬¬ä¸€æ¬¡æ±‚è§£" class="headerlink" title="ç¬¬ä¸€æ¬¡æ±‚è§£"></a>ç¬¬ä¸€æ¬¡æ±‚è§£</h3><p>é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°å®Œæˆå·¦ç§»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Rotate left lambda</span></span><br><span class="line">rol = <span class="keyword">lambda</span> val, r_bits, max_bits: \</span><br><span class="line">    (val &lt;&lt; r_bits%max_bits) &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>) | \</span><br><span class="line">    ((val &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>)) &gt;&gt; (max_bits-(r_bits%max_bits)))</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ›å»ºå‡ºé¢„å®šä¹‰çš„æ•°ç»„ï¼Œç”¨Radare2å®Œæˆï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt;  pcp 44 @ 0x4007a0</span><br><span class="line">import struct</span><br><span class="line">buf = struct.pack (â€œ44Bâ€, *[</span><br><span class="line">0x0f,0xc9,0xa8,0x86,0xac,0xe0,0x18,0x93,0x8a,0xaf,0x91,</span><br><span class="line">0xa2,0xe4,0x64,0x7a,0x5a,0x08,0x8b,0xa8,0x9a,0xb4,0xd1,</span><br><span class="line">0x1f,0x84,0xb4,0xd1,0x71,0x52,0x1c,0x8a,0x80,0xd2,0x14,</span><br><span class="line">0x95,0x82,0x97,0x80,0xd2,0x1f,0x90,0x8f,0x91,0x93,0xa6])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>pc</code>å­å‘½ä»¤ç”¨æ¥æŒ‰å­—èŠ‚é€šè¿‡C, Python, Javascriptç­‰è¯­è¨€çš„æ ¼å¼è¾“å‡ºæ–‡ä»¶å†…æ•°æ®(è¯¦ç»†å¯çœ‹<code>pc?</code>)ã€‚</p>
</blockquote>
<p>æŠŠè¿™ä¸ªåŠ å…¥è„šæœ¬å¹¶å®šä¹‰å˜é‡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Byte array from 0x004007A0, modified from the generated results of `pcp 44 @ 0x4007a0`</span></span><br><span class="line">arr =[<span class="number">0x0F</span>, <span class="number">0xC9</span>, <span class="number">0xA8</span>, <span class="number">0x86</span>, <span class="number">0xAC</span>, <span class="number">0xE0</span>, <span class="number">0x18</span>, <span class="number">0x93</span>, <span class="number">0x8A</span>, <span class="number">0xAF</span>, <span class="number">0x91</span>, <span class="number">0xA2</span>, <span class="number">0xE4</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>, <span class="number">0x5A</span>, <span class="number">0x08</span>, <span class="number">0x8B</span>, <span class="number">0xA8</span>, <span class="number">0x9A</span>, <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x1F</span>, <span class="number">0x84</span>, <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x71</span>, <span class="number">0x52</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0x82</span>, <span class="number">0x97</span>, <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x1F</span>, <span class="number">0x90</span>, <span class="number">0x8F</span>, <span class="number">0x91</span>, <span class="number">0x93</span>, <span class="number">0xA6</span>]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initial key value </span></span><br><span class="line">key = <span class="number">0xdc77df87</span></span><br><span class="line"> </span><br><span class="line">flag = []</span><br></pre></td></tr></table></figure>
<p>æœ€åå®ç°é€»è¾‘ç„¶åç»„åˆåœ¨ä¸€èµ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Rotate left lambda</span></span><br><span class="line">rol = <span class="keyword">lambda</span> val, r_bits, max_bits: \</span><br><span class="line">    (val &lt;&lt; r_bits%max_bits) &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>) | \</span><br><span class="line">    ((val &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>)) &gt;&gt; (max_bits-(r_bits%max_bits)))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Byte array from 0x004007A0, modified from the generated results of `pcp 44 @ 0x4007a0`</span></span><br><span class="line">arr =[<span class="number">0x0F</span>, <span class="number">0xC9</span>, <span class="number">0xA8</span>, <span class="number">0x86</span>, <span class="number">0xAC</span>, <span class="number">0xE0</span>, <span class="number">0x18</span>, <span class="number">0x93</span>, <span class="number">0x8A</span>, <span class="number">0xAF</span>, <span class="number">0x91</span>, <span class="number">0xA2</span>, <span class="number">0xE4</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>, <span class="number">0x5A</span>, <span class="number">0x08</span>, <span class="number">0x8B</span>, <span class="number">0xA8</span>, <span class="number">0x9A</span>, <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x1F</span>, <span class="number">0x84</span>, <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x71</span>, <span class="number">0x52</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0x82</span>, <span class="number">0x97</span>, <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x1F</span>, <span class="number">0x90</span>, <span class="number">0x8F</span>, <span class="number">0x91</span>, <span class="number">0x93</span>, <span class="number">0xA6</span>]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initial key value </span></span><br><span class="line">key = 0x????????</span><br><span class="line"> </span><br><span class="line">flag = []</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Iterate the array backwards</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> reversed(arr):</span><br><span class="line">    <span class="comment"># rol the key </span></span><br><span class="line">    key = rol(key,<span class="number">1</span>,<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># xor the 8 lower bits of the key with current byte in array</span></span><br><span class="line">    char = chr(b ^ (key &amp; <span class="number">0xff</span>))</span><br><span class="line">    <span class="comment"># Add char to final flag</span></span><br><span class="line">    flag.insert(<span class="number">0</span>, char)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">print</span> <span class="string">'[+] Flag: '</span>, <span class="string">''</span>.join(flag)</span><br></pre></td></tr></table></figure>
<p>ä¸é”™ï¼Œç°åœ¨åªéœ€è¦è·å–åˆå§‹å€¼å°±è¡Œäº†ã€‚åº”è¯¥åœ¨åˆå§‹å€¼ç”Ÿæˆå¾ªç¯åä¸‹æ–­ç‚¹ç„¶åæŸ¥çœ‹å³å¯ã€‚Radare2è°ƒè¯•æ¨¡å¼å¯åŠ¨<code>r2 -d packedup</code>æˆ–è€…å·²ç»åœ¨radare2é‡Œå°±ç”¨<code>ood</code>æŒ‡ä»¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[0x0040060c]&gt;  ood</span><br><span class="line">Process with PID 1236 startedâ€¦</span><br><span class="line">File dbg:///home/beet/Desktop/Security/r2con/crackmes/packedup reopened <span class="keyword">in</span> <span class="built_in">read</span>-write mode</span><br><span class="line">= attach 1236 1236</span><br><span class="line">[0x7fb45818cf30]&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>ood</code>æŒ‡ä»¤å°†åœ¨è°ƒè¯•æ¨¡å¼é‡æ–°æ‰“å¼€å½“å‰æ–‡ä»¶ã€‚å®ƒæ˜¯<code>oo</code>æŒ‡ä»¤(è´Ÿè´£å¤„ç†å·²æ‰“å¼€æ–‡ä»¶)çš„å­æŒ‡ä»¤ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°å½“å‰å®šä½è¢«æ›´æ”¹æˆäº†<code>0x7fb45818cf30</code>ï¼Œè¿™æ˜¯åŠ¨æ€åŠ è½½å™¨(ld.so)å†…å­˜ä¸­çš„åœ°å€ã€‚é€šè¿‡<code>dm.</code>æŒ‡ä»¤å°±èƒ½æ–¹ä¾¿çš„çŸ¥é“:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[0x7fb45818cf30]&gt; dm.</span><br><span class="line">/usr/lib/ld-2.26.so</span><br><span class="line">dm. is used to show the</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>dm.</code>ç”¨æ¥æ˜¾ç¤ºå½“å‰åœ°å€æ˜ å°„åˆ°çš„åŒºå—åã€‚ç”¨<code>dm</code>èƒ½åˆ—å‡ºå½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„ä¿¡æ¯ï¼Œç”¨<code>dm?</code>èƒ½çœ‹åˆ°æ›´å¤šå­æŒ‡ä»¤ã€‚</p>
</blockquote>
<p>å·²çŸ¥å¾ªç¯å°¾ç«¯åœ¨<code>0x0040066d</code>ï¼Œè®¡ç®—ç»“æœåœ¨<code>ecx</code>ï¼Œæ­£è¦ç§»åˆ°<code>edx</code>ã€‚è®¾å®šæ–­ç‚¹æ¥æŸ¥çœ‹<code>ecx</code>å†…å®¹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[0x7fb45818cf30]&gt; db 0x40066d</span><br><span class="line">[0x7fb45818cf30]&gt; dc</span><br><span class="line">Welcome to packedup <span class="keyword">for</span> r2crackmes ğŸ™‚</span><br><span class="line">Flag &lt;&lt; Blah_blah_blah</span><br><span class="line">hit breakpoint at: 40066d</span><br><span class="line"></span><br><span class="line">[0x0040066d]&gt; dr ecx</span><br><span class="line">0xd477d83e</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>db</code>è´Ÿè´£è®¾å®šè°ƒè¯•æ–­ç‚¹ï¼Œ<code>db?</code>å¯çœ‹åˆ°å…¶å­æŒ‡ä»¤ã€‚<br><code>dc</code>è´Ÿè´£è°ƒè¯•æ—¶ç»§ç»­æ‰§è¡Œã€‚<br><code>dr</code>è´Ÿè´£æ˜¾ç¤ºè°ƒè¯•æ—¶å¯„å­˜å™¨çš„å€¼ï¼Œ<code>db?</code>å¯çœ‹åˆ°å…¶å­æŒ‡ä»¤ã€‚<br><code>d?</code>å¯ä»¥çœ‹å’Œè°ƒè¯•ç›¸å…³çš„æ‰€æœ‰æŒ‡ä»¤</p>
</blockquote>
<p>é‚£ä¹ˆæŠŠåˆå§‹å€¼å¡«å…¥è„šæœ¬<code>key = 0xd477d83e</code>å¹¶æ‰§è¡Œ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beet:~$ python answer.py</span><br><span class="line">[+] Flag:  Hj.xIgYj&#123;u]J*l=ok\S6?TJbgh</span><br></pre></td></tr></table></figure>
<p>ä»€ä¹ˆï¼Ÿè¿™flagçœ‹èµ·æ¥ä¸å¯èƒ½æ˜¯å¯¹çš„ã€‚åˆ†æè¿‡ç¨‹è‚¯å®šå“ªé‡Œå‡ºäº†é—®é¢˜ï¼</p>
<p>å“¦å¯¹äº†ï¼æˆ‘æ€ä¹ˆæ²¡æƒ³åˆ°ï¼è¿˜è®°å¾—ä¹‹å‰è¯´è¿‡çš„å—ï¼Ÿ</p>
<blockquote>
<p>ä¸‹ä¸€éƒ¨åˆ†ï¼Œç¨‹åºä½¿ç”¨åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ä½¿ç”¨è‡ªèº«çš„ä»£ç è®¡ç®—å‡ºäº†ä¸€ä¸ªåˆå§‹å€¼ã€‚</p>
</blockquote>
<p>æŠŠè¿™ä¸ªç»™å¿˜äº†ã€‚ä½¿ç”¨è½¯æ–­ç‚¹<code>db 0x40066d</code>äº‹å®ä¸Šåœ¨ä»£ç ä¸­åŠ å…¥äº†<code>CC</code>(INT3)ï¼Œè¿™æ”¹å˜äº†åŸå§‹ä»£ç å¯¼è‡´äº†åˆå§‹å€¼è®¡ç®—å‡ºé”™ã€‚INT3æŒ‡ä»¤ç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„å•å­—èŠ‚æ±‡ç¼–æŒ‡ä»¤<code>CC</code>ç”¨æ¥è°ƒç”¨è°ƒè¯•å™¨å®Œæˆ(å¼‚å¸¸)å¤„ç†ã€‚</p>
<h3 id="ç¬¬äºŒæ¬¡æ±‚è§£"><a href="#ç¬¬äºŒæ¬¡æ±‚è§£" class="headerlink" title="ç¬¬äºŒæ¬¡æ±‚è§£"></a>ç¬¬äºŒæ¬¡æ±‚è§£</h3><p>æ‰€ä»¥è¿™æ¬¡ä½¿ç”¨<a href="https://reverseengineering.stackexchange.com/questions/16544/detecting-hardware-breakpoints/16547#16547" target="_blank" rel="noopener">ç¡¬æ–­ç‚¹</a>ï¼Œç¦ç”¨ä¹‹å‰è®¾å®šçš„è½¯æ–­ç‚¹å¹¶è®¾ç½®ç¡¬æ–­ç‚¹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[0x40066d]&gt; db- 0x40066d</span><br><span class="line">[0x40066d]&gt; ood</span><br><span class="line">Process with PID 1317 startedâ€¦</span><br><span class="line">File dbg:///home/beet/Desktop/Security/r2con/crackmes/packedup reopened <span class="keyword">in</span> <span class="built_in">read</span>-write mode</span><br><span class="line">= attach 1317 1317</span><br><span class="line"></span><br><span class="line">[0x7fcb28f77f30]&gt; drx 1 0x0040066d 1 x</span><br><span class="line">[0x7fcb28f77f30]&gt; dc</span><br><span class="line">Welcome to packedup <span class="keyword">for</span> r2crackmes </span><br><span class="line">Flag &lt;&lt; Blah_Megabeets_Blahaaa</span><br><span class="line"></span><br><span class="line">[0x0040066d]&gt; dr ecx</span><br><span class="line">0xdc77df87</span><br></pre></td></tr></table></figure>
<p>é‡æ–°å¡«å…¥åˆå§‹å€¼å¹¶å†æ¬¡å°è¯•:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beet:~$ python answer.py</span><br><span class="line">[+] Flag: [<span class="string">'\xc8'</span>, <span class="string">'*'</span>, <span class="string">'\xd9'</span>, <span class="string">'&gt;'</span>, <span class="string">'p'</span>, <span class="string">'\x0e'</span>, <span class="string">'\xef'</span>, <span class="string">'h'</span>, <span class="string">'\xf7'</span>, <span class="string">'\x91'</span>, <span class="string">'\x8e'</span>, <span class="string">'\xad'</span>, <span class="string">'c'</span>, <span class="string">'\xa7'</span>, <span class="string">'\x9b</span></span><br></pre></td></tr></table></figure>
<p>åˆ«è¿™æ ·å•Šâ€¦åˆé”™äº†ã€‚æˆ‘è¿˜é—æ¼äº†ä»€ä¹ˆï¼Ÿ</p>
<p>æ—¢ç„¶è¿˜åœ¨è°ƒè¯•æ¨¡å¼ï¼Œé‚£ä¹ˆä»éªŒè¯å¾ªç¯çš„å¼€å§‹<code>0x0040067b</code>å•æ­¥æ‰§è¡Œæ£€æŸ¥ä¸€éã€‚</p>
<p>æ±‡ç¼–:<code>0x00400680 d1c8 ror eax, 1</code><br>è§£é‡Š:</p>
<blockquote>
<p>ç„¶ååœ¨<em>0x00400680</em>ï¼Œ<code>eax</code>è¢«å·¦ç§»äº†1å­—èŠ‚</p>
</blockquote>
<p>æ…¢ç€ï¼ä¹‹å‰åˆ†ææ˜¯<strong>å·¦</strong>ç§»1å­—èŠ‚(<code>rol eax, 1</code>)ï¼Œä½†ç°åœ¨æ˜¯<strong>å³</strong>ç§»1å­—èŠ‚(<code>ror eax, 1</code>)ï¼Ÿï¼éš¾æ€ªå¾—åˆ°äº†é”™è¯¯çš„flagï¼Œä½†æ˜¯è¿™æ˜¯ä»€ä¹ˆæ—¶å€™æ”¹å˜çš„ï¼Ÿ</p>
<p>ä¸ºäº†å¼„æ˜ç™½è¿™ä¸ªé—®é¢˜ï¼Œåœ¨<code>0x00400680</code>ä¸Šè®¾å®šç¡¬ä»¶æ–­ç‚¹æ£€æµ‹<strong>å†™å…¥</strong>è®¿é—®æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆæ—¶å€™æ”¹å˜çš„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[0x40066d]&gt; doo</span><br><span class="line">Process with PID 1611 startedâ€¦</span><br><span class="line">File dbg:///home/beet/Desktop/Security/r2con/crackmes/packedup reopened <span class="keyword">in</span> <span class="built_in">read</span>-write mode</span><br><span class="line">= attach 1611 1611</span><br><span class="line"></span><br><span class="line">[0x7fc43ae24f30]&gt; drx 1 0x00400680 1 w</span><br><span class="line">[0x7fc43ae24f30]&gt; dc</span><br><span class="line">[0x00400600]&gt;</span><br></pre></td></tr></table></figure>
<p>è°ƒè¯•åœæ­¢åœ¨<code>0x400600</code>ï¼Œæ‰“å°æ±‡ç¼–çœ‹çœ‹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[0x00400600]&gt; pd 1</span><br><span class="line">0x00400600   67c6406dc8   mov byte [eax + 0x6d], 0xc8</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯è¿™ä¸ªä¿®æ”¹äº†è¯¥åœ°å€ä¸Šçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œ<code>rol eax, 1</code>å¯¹åº”çš„åº”è¯¥æ˜¯<code>dlc0</code>ï¼Œè¿™é‡Œæ”¹æˆäº†<code>dlc8</code>ï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨radare2åæ±‡ç¼–16è¿›åˆ¶å­—ç¬¦ä¸²çœ‹çœ‹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[0x00400600]&gt; pad d1c0</span><br><span class="line">rol eax, 1</span><br><span class="line">[0x00400600]&gt; <span class="comment"># changed to</span></span><br><span class="line">[0x00400600]&gt; pad d1c8</span><br><span class="line">ror eax, 1</span><br></pre></td></tr></table></figure>
<p>æ‰“å°æ•´ä¸ªå‡½æ•°çœ‹çœ‹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[0x00400600]&gt; pdf</span><br><span class="line">â•­ (fcn) entry2.init 77</span><br><span class="line">â”‚   entry2.init ();</span><br><span class="line">â”‚           0x004005bd      90             nop</span><br><span class="line">â”‚           0x004005be      90             nop</span><br><span class="line">â”‚           0x004005bf      90             nop</span><br><span class="line">â”‚           0x004005c0      90             nop</span><br><span class="line">â”‚           0x004005c1      b87d000000     mov eax, 0x7d               ; â€˜&#125;â€™ ; 125</span><br><span class="line">â”‚           0x004005c6      bbff0f0000     mov ebx, 0xfff</span><br><span class="line">â”‚           0x004005cb      f7db           neg ebx</span><br><span class="line">â”‚           0x004005cd      ffcb           dec ebx</span><br><span class="line">â”‚           0x004005cf      81e314064000   and ebx, 0x400614</span><br><span class="line">â”‚           0x004005d5      b9f6064000     mov ecx, 0x4006f6</span><br><span class="line">â”‚           0x004005da      81e914064000   sub ecx, 0x400614</span><br><span class="line">â”‚           0x004005e0      ba07000000     mov edx, 7</span><br><span class="line">â”‚           0x004005e5      cd80           int 0x80</span><br><span class="line">â”‚           0x004005e7      b814064000     mov eax, 0x400614</span><br><span class="line">â”‚           0x004005ec      67c64050c1     mov byte [eax + 0x50], 0xc1 ; [0xc1:1]=255 ; 193</span><br><span class="line">â”‚           0x004005f1      67c64051c1     mov byte [eax + 0x51], 0xc1 ; [0xc1:1]=255 ; 193</span><br><span class="line">â”‚           0x004005f6      67c6405203     mov byte [eax + 0x52], 3</span><br><span class="line">â”‚           0x004005fb      67c6406cd1     mov byte [eax + 0x6c], 0xd1 ; [0xd1:1]=255 ; 209</span><br><span class="line">;â€“ rip:</span><br><span class="line">â”‚           0x00400600      67c6406dc8     mov byte [eax + 0x6d], 0xc8 ; [0xc8:1]=255 ; 200</span><br><span class="line">â•°       â•­â”€&lt; 0x00400605      e902000000     jmp main</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°è¢«Radare2å‘½åä¸º<code>entry2.init</code>ã€‚èƒ½çœ‹åˆ°åœ¨<em>0x4005c1</em>ä¸Š<code>0x7d</code>ç§»å…¥<code>eax</code>ç„¶ååœ¨<em>0x4005e5</em>ä¸Šsyscall(int 80)æŒ‡ä»¤è¢«æ‰§è¡Œã€‚è¿™è°ƒç”¨äº†<code>mprotect</code>å‡½æ•°ä¿®æ”¹.textåŒºæ®µæƒé™ä½¿å…¶å¯å†™ï¼Œä¹‹åå†ä¿®æ”¹mainå‡½æ•°ä¸­çš„<code>rol</code>å˜æˆ<code>ror</code>ã€‚</p>
<h4 id="init-array"><a href="#init-array" class="headerlink" title=".init_array"></a>.init_array</h4><p><code>entry2.init</code>æ˜¯åˆå§‹åŒ–å‡½æ•°ï¼Œåœ¨mainå‡½æ•°ä¹‹å‰æ‰§è¡Œï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¼šé—æ¼å®ƒã€‚</p>
<p>åœ¨æ‰§è¡Œåˆ°mainå‡½æ•°ä¹‹å‰ï¼Œè¿è¡Œæ—¶é“¾æ¥å™¨æ‰§è¡Œè¯¥ç¨‹åºåˆå§‹åŒ–æ®µ(<code>.preinit_array</code>å’Œ<code>.init_array</code>)ä¸­ä¿å­˜çš„åœ°å€æ‰€æŒ‡å®šçš„ä»»æ„å‡½æ•°ã€‚è¿™äº›å‡½æ•°é€šå¸¸æ˜¯æ„é€ å‡½æ•°ï¼ŒåŒç†<code>.fini_array</code>æ®µä¸­ä¿å­˜çš„æ˜¯ç¨‹åºæ­£å¸¸é€€å‡ºå‰éœ€è¦æ‰§è¡Œçš„ææ„å‡½æ•°ã€‚</p>
<p>Radare2åŒæ ·æ˜¯è¯†åˆ«å‡ºäº†<code>.init_array</code>æ®µ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[0x00400600]&gt; f~init_array</span><br><span class="line">0x00600e08 16 section..init_array</span><br><span class="line">0x00600e18 0 section_end..init_array</span><br><span class="line">[0x00400600]&gt; pxW 24 @ section..init_array</span><br><span class="line">0x00600e08 0x00400590 entry1.init</span><br><span class="line">0x00600e0c 0x00000000 section.</span><br><span class="line">0x00600e10 0x004005bd entry2.init</span><br><span class="line">0x00600e14 0x00000000 section.</span><br><span class="line">0x00600e18 0x00400570 entry3.fini</span><br><span class="line">0x00600e1c 0x00000000 section.</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>f</code>ç”¨æ¥åˆ—å‡ºradareåˆ›å»ºçš„æ ‡è®°<br><code>~</code>æ˜¯radareå†…å»ºçš„grep<br><code>pxW</code>æŒ‰16è¿›åˆ¶æ‰“å°åŒå­—(32ä½)</p>
</blockquote>
<p>èƒ½çœ‹åˆ°å…¶ä¸­æœ‰ä¸¤ä¸ªå‡½æ•°ï¼ŒåŒ…æ‹¬<code>entry2.init</code>ã€‚</p>
<p>é¡ºå¸¦ä¸€æï¼Œåœ¨<code>gcc</code>ä¸­å®šä¹‰åˆå§‹åŒ–å‡½æ•°å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»ä¼¼çš„æ¨¡æ¿:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __attribute__ ((constructor)) some_func() &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// code goes here</span></span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬ä¸‰æ¬¡æ±‚è§£"><a href="#ç¬¬ä¸‰æ¬¡æ±‚è§£" class="headerlink" title="ç¬¬ä¸‰æ¬¡æ±‚è§£"></a>ç¬¬ä¸‰æ¬¡æ±‚è§£</h3><p>ç°åœ¨æŠŠè„šæœ¬ä¸­çš„<code>rol</code>å˜æˆ<code>ror</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Rotate right lambda</span></span><br><span class="line">ror = <span class="keyword">lambda</span> val, r_bits, max_bits: \</span><br><span class="line">    ((val &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>)) &gt;&gt; r_bits%max_bits) | \</span><br><span class="line">    (val &lt;&lt; (max_bits-(r_bits%max_bits)) &amp; (<span class="number">2</span>**max_bits<span class="number">-1</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Byte array from 0x004007A0, modified from the generated results of `pcp 44 @ 0x4007a0`</span></span><br><span class="line">arr = [</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0xC9</span>, <span class="number">0xA8</span>, <span class="number">0x86</span>, <span class="number">0xAC</span>, <span class="number">0xE0</span>, <span class="number">0x18</span>, <span class="number">0x93</span>, <span class="number">0x8A</span>, <span class="number">0xAF</span>, <span class="number">0x91</span>, <span class="number">0xA2</span>,</span><br><span class="line">    <span class="number">0xE4</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>, <span class="number">0x5A</span>, <span class="number">0x08</span>, <span class="number">0x8B</span>, <span class="number">0xA8</span>, <span class="number">0x9A</span>, <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x1F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0xB4</span>, <span class="number">0xD1</span>, <span class="number">0x71</span>, <span class="number">0x52</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0x82</span>, <span class="number">0x97</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0xD2</span>, <span class="number">0x1F</span>, <span class="number">0x90</span>, <span class="number">0x8F</span>, <span class="number">0x91</span>, <span class="number">0x93</span>, <span class="number">0xA6</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initial key value</span></span><br><span class="line">key = <span class="number">0xdc77df87</span></span><br><span class="line"> </span><br><span class="line">flag = []</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Iterate the array backwards</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> reversed(arr):</span><br><span class="line">    <span class="comment"># ror the key</span></span><br><span class="line">    key = ror(key, <span class="number">1</span>, <span class="number">32</span>)</span><br><span class="line">    <span class="comment"># xor the 8 lower bits of the key with current byte in array</span></span><br><span class="line">    char = chr(b ^ (key &amp; <span class="number">0xff</span>))</span><br><span class="line">    <span class="comment"># Add char to final flag</span></span><br><span class="line">    flag.insert(<span class="number">0</span>, char)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">print</span> <span class="string">'[+] Flag: '</span>, <span class="string">''</span>.join(flag)</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰æ¬¡æ‰§è¡Œï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beet:~$ python answer.py</span><br><span class="line">[+] Flag:  r2_is_for_packedup_things_like_linux_malware</span><br></pre></td></tr></table></figure>
<p>æ±‚è§£å®Œæ¯•ï¼</p>
<h2 id="å°¾å£°"><a href="#å°¾å£°" class="headerlink" title="å°¾å£°"></a>å°¾å£°</h2><p>å¦‚æœä½ æƒ³æ›´å¤šäº†è§£Radare2å»ºè®®çœ‹çœ‹Radare2ä¹‹æ—…çš„<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a>å’Œ<a href="https://www.megabeets.net/a-journey-into-radare-2-part-2" target="_blank" rel="noopener">ç¬¬äºŒéƒ¨åˆ†</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Translated/" rel="tag"># Translated</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/12/Decrypting-Dropshot-Malware-with-Radare2-and-Cutterâ€“Part1/" rel="next" title="Decrypting-Dropshot-Malware-with-Radare2-and-Cutterâ€“Part1">
                <i class="fa fa-chevron-left"></i> Decrypting-Dropshot-Malware-with-Radare2-and-Cutterâ€“Part1
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/24/wepoll-source-code-analysis/" rel="prev" title="wepoll-source-code-analysis">
                wepoll-source-code-analysis <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">FX-Ti</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">175</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://iv4n.xyz/" title="iv4n" target="_blank">iv4n</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶"><span class="nav-number">1.</span> <span class="nav-text">ç”¨Radare2é€†å‘ä¸€ä¸ªè‡ªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#åºè¨€"><span class="nav-number">1.1.</span> <span class="nav-text">åºè¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è·å–Radare2"><span class="nav-number">1.2.</span> <span class="nav-text">è·å–Radare2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">1.2.1.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‡çº§"><span class="nav-number">1.2.2.</span> <span class="nav-text">å‡çº§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#packedup"><span class="nav-number">1.2.3.</span> <span class="nav-text">packedup</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¼€å§‹é€†å‘ï¼"><span class="nav-number">1.3.</span> <span class="nav-text">å¼€å§‹é€†å‘ï¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ†æ"><span class="nav-number">1.3.1.</span> <span class="nav-text">åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è·å–ä¿¡æ¯"><span class="nav-number">1.3.2.</span> <span class="nav-text">è·å–ä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å­—ç¬¦ä¸²"><span class="nav-number">1.3.3.</span> <span class="nav-text">å­—ç¬¦ä¸²</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®šä½"><span class="nav-number">1.3.4.</span> <span class="nav-text">å®šä½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åæ±‡ç¼–"><span class="nav-number">1.3.5.</span> <span class="nav-text">åæ±‡ç¼–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬ä¸€æ¬¡æ±‚è§£"><span class="nav-number">1.3.6.</span> <span class="nav-text">ç¬¬ä¸€æ¬¡æ±‚è§£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬äºŒæ¬¡æ±‚è§£"><span class="nav-number">1.3.7.</span> <span class="nav-text">ç¬¬äºŒæ¬¡æ±‚è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#init-array"><span class="nav-number">1.3.7.1.</span> <span class="nav-text">.init_array</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬ä¸‰æ¬¡æ±‚è§£"><span class="nav-number">1.3.8.</span> <span class="nav-text">ç¬¬ä¸‰æ¬¡æ±‚è§£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å°¾å£°"><span class="nav-number">1.4.</span> <span class="nav-text">å°¾å£°</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FX-Ti</span>

  

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
